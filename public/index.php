<?php
/**
 * -----------------------------------------------------------------------------------------------------------|
 * TORNADO-HTTP | Skeleton Application                                                                        |
 *                                                                                                            |
 * Tornado HTTP es un Contenedor Action para Aplicaciones                                                 |
 *                                                                                                            |
 * -----------------------------------------------------------------------------------------------------------|
 * ATENCIÃ“N: Edite bajo su riego, el tornado lo puedo arrasar.                                                |
 * -----------------------------------------------------------------------------------------------------------|
 *                                                                                                            |
 *                                                     ,''                                                    |
 *                                                     @@@                                                    |
 *                                                     @@:                                                    |
 *                                                     @@                                                     |
 *                                          @@@@@@@+   @@@@@@@   @@@@@@@`  .@@#:`                             |
 *                                          @@@@@@@@. ;@@@@@@@'  @@@@@@@@    :@@@@@@#,                        |
 *                                          @@`   @@@ @@@   @@' .@@    @@`       ,@@@@@@@,                    |
 *                           .:+@@@@@@      @@    @@@ @@:   @@, +@@    @@`          ,@@@@@@@:                 |
 *                      ;#@@@@@@@'`        :@@    @@+ @@    @@  @@#    @@              '@@@@@@@.              |
 *                  :@@@@@@@'.             @@@    @@  @@   `@@  @@,   #@@                ,@@@@@@@:            |
 *              `+@@@@@@@,                 @@'   @@@ ;@@   +@@  @@   ,@@:                  ,@@@@@@@:          |
 *            ;@@@@@@@:                    @@@@@@@@  @@@   @@# .@@@@@@@@                     @@@@@@@@`        |
 *          #@@@@@@@.                      @@@@@@'   @@:   @@, +@@@@@@.                       :@@@@@@@+       |
 *        @@@@@@@@.                       ,@@                  @@#        @@@'`                `@@@@@@@@      |
 *      '@@@@@@@'                         @@@                  @@.         .@@@@@'`             ,@@@@@@@@     |
 *     @@@@@@@@.               `,;##'.    @@'                  @@            ;@@@@@@+            @@@@@@@@;    |
 *    @@@@@@@@`            `+@@@@@@#                                           '@@@@@@#          ,@@@@@@@@    |
 *   @@@@@@@@+           +@@@@@@@:                                               +@@@@@@;        `@@@@@@@@,   |
 *   @@@@@@@@          #@@@@@@@.                                                   @@@@@@@       `@@@@@@@@#   |
 *  '@@@@@@@@        ,@@@@@@@`                                                      ;@@@@@@      '@@@@@@@@#   |
 *  #@@@@@@@@       '@@@@@@,                                                         '@@@@@:     @@@@@@@@@.   |
 *  ,@@@@@@@@      ,@@@@@@               :##                           +@@#`          @@@@@@    +@@@@@@@@@    |
 *   @@@@@@@@@     @@@@@@            '@@@#                              `@@@@         @@@@@@.  :@@@@@@@@@;    |
 *   ,@@@@@@@@;   ;@@@@@'         `@@@@`                                  @@@@`       @@@@@@# :@@@@@@@@@@     |
 *    ;@@@@@@@@#  @@@@@@.        @@@@                                      @@@@      ,@@@@@@@+@@@@@@@@@@      |
 *     .@@@@@@@@@.#@@@@@@       @@@@             `,''@@@@#;;,.             #@@@:    `@@@@@@@@@@@@@@@@@;       |
 *       @@@@@@@@@@@@@@@@+     `@@@@        `+@@@@@@@@@@@@@@@@@@@;         +@@@@   .@@@@@@@@@@@@@@@@@ `       |
 *        `@@@@@@@@@@@@@@@@    `@@@@       #@@@@@@@@@@@@@@@@@@@@@@@        @@@@@  #@@@@@@@@@@@@@@@@. #.       |
 *           ;@@@@@@@@@@@@@@;   @@@@        @@@@@@@@@@@@@@@@@@@@@@@       @@@@@++@@@@@@@@@@@@@@@@` ,@@        |
 *              ;@@@@@@@@@@@@@#.;@@@@.       @@@@@@@@@@@@@@@@@@@@@`     `@@@@@@@@@@@@@@@@@@@@@:  `@@@'        |
 *                 @@@@@@@@@@@@@@@@@@@@`       ;@@@@@@@@@@@@@@;`      `@@@@@@@@@@@@@@@@@@@@,   `@@@@@         |
 *                 '@@@@#@@@@@@@@@@@@@@@@#.                        .#@@@@@@@@@@@@@@@@@@+.    ,@@@@@@          |
 *                  @@@@@+ `+@@@@@@@@@@@@@@@@@#'``           .;+@@@@@@@@@@@@@@@@@@@+`      +@@@@@@@           |
 *                   +@@@@@;    .:+@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@:.        ;@@@@@@@@#            |
 *                    ,@@@@@@'          `::++#@@@@@@@@@@@@@@@@@@@@@#++::`           ,#@@@@@@@@@@              |
 *                      @@@@@@@@.                                              `'@@@@@@@@@@@@#                |
 *                       `@@@@@@@@@.         ```                       `,;+@@@@@@@@@@@@@@@'`                  |
 *                       #; #@@@@@@@@@.  '#@@@@@@@@@@@+;.,.:'++@@@@@@@@@@@@@@@@@@@@@@#;`         .@+          |
 *                        @@@,,@@@@@@@@@@;     `.:#@@@@@@@@@@@@@@@@@@@@@@@@@@@@#;.`            +@@@           |
 *                         @@@@; :@@@@@@@@@@@;`             `,,,.,,,.,,.`                  `+@@@@@,           |
 *                          @@@@@+  ,@@@@@@@@@@@@#,                                     '@@@@@@@@+            |
 *                           @@@@@@'   .#@@@@@@@@@@@@@@+:`                        .:#@@@@@@@@@@@,             |
 *                            +@@@@@@#     .+@@@@@@@@@@@@@@@@@@@##':,,:,,;'#@@@@@@@@@@@@@@@@@@+               |
 *                             `@@@@@@@@:      .'@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@,                 |
 *                               #@@@@@@@@@;        .:@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@#.                     |
 *                                 #@@@@@@@@@@#.          `,:+#@@@@@@@@@@@@@@@@+:.           .@               |
 *                                   #@@@@@@@@@@@@'`                                       '@@+               |
 *                                     :@@@@@@@@@@@@@@+.                                ,@@@@@                |
 *                                        '@@@@@@@@@@@@@@@@#:`                     `,#@@@@@@@'                |
 *                                           `#@@@@@@@@@@@@@@@@@@@@+':;:,,,::;+#@@@@@@@@@@@@'                 |
 *                                               `:#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@                   |
 *                                       `+',`          .+#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@;                     |
 *                                        `@@@@@'`                  `..````......`.`                          |
 *                                          @@@@@@@@.                                                         |
 *                                           :@@@@@@@@@;                                                      |
 *                                             +@@@@@@@@@@@;,`         .,,;;+@@@                              |
 *                                               ;@@@@@@@@@@@@@@@@@@@@@@@@@@@@,                               |
 *                                          @#     `#@@@@@@@@@@@@@@@@@@@@@@@'                                 |
 *                                          '@@@.      :@@@@@@@@@@@@@@@@@#.                                   |
 *                                           @@@@@@.        `;'####+',                                        |
 *                                            +@@@@@@@@',                                                     |
 *                                             .@@@@@@@@@@@@@@@@@@#######`                                    |
 *                                               #@@@@@@@@@@@@@@@@@@@@@@                                      |
 *                                          @.     @@@@@@@@@@@@@@@@@@@:                                       |
 *                                          +@@.     ,#@@@@@@@@@@@@+`                                         |
 *                                           @@@@#,      ``.,,.``                                             |
 *                                            @@@@@@@@@+:';:,,,.`                                             |
 *                                             @@@@@@@@@@@@@@@@@@                                             |
 *                                              ;@@@@@@@@@@@@@@@                                              |
 *                                                '@@@@@@@@@@@`                                               |
 *                                                   ,+@##'`                                                  |
 *                                         @@'`                                                               |
 *                                         '@@@@@@#+;;'#                                                      |
 *                                          @@@@@@@@@@@:                                                      |
 *                                           @@@@@@@@@,                                                       |
 *                                           :@@@@@@@,                                                        |
 *                                            :@@@@@,                                                         |
 *                                             :@@@#                                                          |
 *                                              `@@                                                           |
 *                                                @                                                           |
 *                                                                                                            |
 * ---------------------------------- Generado por: http://picascii.com ------------------------------------- |
 */
namespace App;

use DMS\TornadoHttp\TornadoHttp;
use Zend\Diactoros\Response;
use Zend\Diactoros\ServerRequestFactory;
use Zend\ServiceManager\Config;
use Zend\ServiceManager\ServiceManager;

require '../vendor/autoload.php';

$container = new ServiceManager(
    new Config(
        require '../app/services.php'
    )
);

$app = new TornadoHttp();
$app->setDI($container);

$request     = ServerRequestFactory::fromGlobals();
$response    = new Response();

$method = $request->getMethod();
$path   = $request->getUri()->getPath();

$middlewares = [];

foreach(require('../app/middlewares.php') as $middleware) {
    if (isset($middleware['methods']) && !in_array($method, $middleware['methods'])) {
        continue;
    }
    if (isset($middleware['path']) && preg_match($middleware['path'], $path) !== 1) {
        continue;
    }
    $middlewares[] = $middleware['middleware'];
}
//var_dump($middlewares);
$app->add($middlewares);

$app($request, $response);
